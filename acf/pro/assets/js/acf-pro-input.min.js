!function($){var t=acf.Field.extend({type:"repeater",events:{'click a[data-event="add-row"]':"onClickAdd",'click a[data-event="remove-row"]':"onClickRemove",'click a[data-event="collapse-row"]':"onClickCollapse",showField:"onShow"},getControl:function(){return this.$(".acf-repeater:first")},$control:function(){return this.$(".acf-repeater:first")},$table:function(){return this.$control().children("table")},$tbody:function(){return this.$table().children("tbody")},$rows:function(){return this.$tbody().children()},$clone:function(){return this.$tbody().children(".acf-clone")},$actions:function(){return this.$control().children(".acf-actions")},$button:function(){return this.$actions().find(".button")},getValue:function(){return this.$rows().length-1},isFull:function(){var t=parseInt(this.get("max"));return t&&this.val()>=t},initialize:function(){this.$el.one("mouseenter",this.newEventCallback(this,"onMouseEnter")),acf.disable(this.$clone(),this.cid),this.render()},render:function(){this.$rows().each(function(t){$(this).find("> .order > span").html(t+1)}),0==this.val()?this.$control().addClass("-empty"):this.$control().removeClass("-empty"),this.isFull()?this.$button().addClass("disabled"):this.$button().removeClass("disabled")},onClickAdd:function(t,e){e.hasClass("acf-icon")?this.add({before:e.closest(".acf-row")}):this.add()},add:function(t){var e=this.$clone();if(t=acf.parseArgs(t,{before:e}),this.isFull())return alert(acf._e("repeater","max").replace("{max}",this.get("max"))),!1;var a=acf.duplicate({target:e,append:function(e,a){a.removeClass("acf-clone"),t.before.before(a)}});return acf.enable_form(a,this.cid),this.render(),this.getInput().trigger("change"),a},onClickRemove:function(t,e){var a=e.closest(".acf-row");a.addClass("-hover");var i=acf.newTooltip({confirmRemove:!0,target:e,context:this,confirm:function(){this.remove(a)},cancel:function(){a.removeClass("-hover")}})},remove:function(t){var e=this;acf.remove({target:t,endHeight:0,complete:function(){e.getInput().trigger("change"),e.render(),acf.do_action("refresh",e.$el)}})},onClickCollapse:function(t,e){var a=e.closest(".acf-row"),i=a.hasClass("-collapsed");t.shiftKey&&(a=this.$rows()),i?(a.removeClass("-collapsed"),acf.do_action("show",a,"collapse")):(a.addClass("-collapsed"),acf.do_action("hide",a,"collapse")),acf.do_action("refresh",this.$el)},onMouseEnter:function(t,e){if(1!=parseInt(this.get("max"))){var a=this;this.$tbody().sortable({items:"> tr",handle:"> td.order",forceHelperSize:!0,forcePlaceholderSize:!0,scroll:!0,stop:function(t,e){a.render()},update:function(t,e){a.getInput().trigger("change")}})}},onShow:function(t,e){acf.findFields({is:":visible",parent:this.$el}).each(function(){acf.do_action("show_field",$(this))})}});acf.registerFieldType(t),acf.registerConditionForFieldType("hasValue","repeater"),acf.registerConditionForFieldType("hasNoValue","repeater"),acf.registerConditionForFieldType("lessThan","repeater"),acf.registerConditionForFieldType("greaterThan","repeater")}(jQuery),function($){var t=acf.Field.extend({type:"flexible_content",events:{'click [data-name="add-layout"]':"onClickAdd",'click [data-name="remove-layout"]':"onClickRemove",'click [data-name="collapse-layout"]':"onClickCollapse",showField:"onShow"},control:".acf-flexible-content:first",getLayoutsWrap:function(){return this.find("> .values")},getLayouts:function(){return this.find("> .values > .layout")},getClonesWrap:function(){return this.find("> .clones")},getClones:function(){return this.find("> .clones > .layout")},getClone:function(t){return this.find('> .clones > .layout[data-layout="'+t+'"]')},getButton:function(){return this.find("> .acf-actions .button")},getPopupHTML:function(){var t=this.find("> .tmpl-popup").html(),e=$(t),a=this.getLayouts(),i=function(t){return a.filter(function(){return $(this).data("layout")===t}).length};return e.find("[data-layout]").each(function(){var t=$(this),e=t.data("min")||0,a=t.data("max")||0,n=t.data("layout")||"",o=i(n);if(a&&o>=a)return void t.addClass("disabled");if(e&&o<e){var s=e-o,r=this.__("required"),l=(s=1)?this.__("layout"):this.__("layouts");r=r.replace("{required}",s),r=r.replace("{label} ",""),r=r.replace("{identifier}",l),r=r.replace("{min}",e),t.append('<span class="badge" title="'+r+'">'+s+"</span>")}}),t=e.outerHTML()},getValue:function(){return this.getLayouts().length},isFull:function(){var t=parseInt(this.get("max"));return t&&this.val()>=t},initialize:function(){this.$el.one("mouseenter",this.newEventCallback(this,"onMouseEnter")),acf.disable(this.getClonesWrap(),this.cid),this.render()},render:function(){this.getLayouts().each(function(t){$(this).find(".acf-fc-layout-order:first").html(t+1)}),0==this.val()?this.getControl().addClass("-empty"):this.getControl().removeClass("-empty"),this.isFull()?this.getButton().addClass("disabled"):this.getButton().removeClass("disabled")},onShow:function(t,e){acf.findFields({is:":visible",parent:this.$el}).each(function(){acf.do_action("show_field",$(this))})},onMouseEnter:function(t,e){if(1!=parseInt(this.get("max"))){var a=this;this.getLayoutsWrap().sortable({items:"> .layout",handle:"> .acf-fc-layout-handle",forceHelperSize:!0,forcePlaceholderSize:!0,scroll:!0,stop:function(t,e){a.render()},update:function(t,e){a.getInput().trigger("change")}})}},onClickAdd:function(t,a){if(!this.isFull()){var i=null;a.hasClass("acf-icon")&&(i=a.closest(".layout"),i.addClass("-hover"));new e({target:a,targetConfirm:!1,text:this.getPopupHTML(),context:this,confirm:function(t,e){e.hasClass("disabled")||this.add({layout:e.data("layout"),before:i})},cancel:function(){i&&i.removeClass("-hover")}}).on("click [data-layout]","onConfirm")}},add:function(t){if(t=acf.parseArgs(t,{layout:"",before:!1}),t.append=this.getLayoutsWrap(),this.isFull())return!1;var e=acf.duplicate({target:this.getClone(t.layout),append:function(e,a){t.before?t.before.before(a):t.append.append(a)}});return acf.enable_form(e,this.cid),this.render(),this.getInput().trigger("change"),e},onClickRemove:function(t,e){var a=e.closest(".layout");a.addClass("-hover");var i=acf.newTooltip({confirmRemove:!0,target:e,context:this,confirm:function(){this.removeLayout(a)},cancel:function(){a.removeClass("-hover")}})},removeLayout:function(t){var e=this,a=1==this.getValue()?60:0;acf.remove({target:t,endHeight:a,complete:function(){e.getInput().trigger("change"),e.render()}})},onClickCollapse:function(t,e){var a=e.closest(".layout");this.renderLayout(a),a.hasClass("-collapsed")?(a.removeClass("-collapsed"),acf.do_action("show",a,"collapse")):(a.addClass("-collapsed"),acf.do_action("hide",a,"collapse"))},renderLayout:function(t){var e=t.children("input"),a=e.attr("name").replace("[acf_fc_layout]",""),i={action:"acf/fields/flexible_content/layout_title",field_key:this.get("key"),i:t.index(),layout:t.data("layout"),value:acf.serialize(t,a)};$.ajax({url:acf.get("ajaxurl"),data:acf.prepareForAjax(i),dataType:"html",type:"post",success:function(e){e&&t.children(".acf-fc-layout-handle").html(e)}})}});acf.registerFieldType(t);var e=acf.models.TooltipConfirm.extend({events:{"click [data-layout]":"onConfirm",'click [data-event="cancel"]':"onCancel"},render:function(){this.html(this.get("text")),this.$el.addClass("acf-fc-popup")}});acf.registerConditionForFieldType("hasValue","flexible_content"),acf.registerConditionForFieldType("hasNoValue","flexible_content"),acf.registerConditionForFieldType("lessThan","flexible_content"),acf.registerConditionForFieldType("greaterThan","flexible_content")}(jQuery),function($){var t=acf.Field.extend({type:"gallery",events:{"click .acf-gallery-add":"onClickAdd","click .acf-gallery-edit":"onClickEdit","click .acf-gallery-remove":"onClickRemove","click .acf-gallery-attachment":"onClickSelect","click .acf-gallery-close":"onClickClose","change .acf-gallery-sort":"onChangeSort","click .acf-gallery-update":"onUpdate"},actions:{validation_begin:"onValidationBegin",validation_failure:"onValidationFailure"},onValidationBegin:function(){acf.disable(this.$sideData(),this.cid)},onValidationFailure:function(){acf.enable(this.$sideData(),this.cid)},getControl:function(){return this.$(".acf-gallery")},$control:function(){return this.$(".acf-gallery")},$collection:function(){return this.$(".acf-gallery-attachments")},$attachments:function(){return this.$(".acf-gallery-attachment")},$attachment:function(t){return this.$('.acf-gallery-attachment[data-id="'+t+'"]')},$active:function(){return this.$(".acf-gallery-attachment.active")},$main:function(){return this.$(".acf-gallery-main")},$side:function(){return this.$(".acf-gallery-side")},$sideData:function(){return this.$(".acf-gallery-side-data")},isFull:function(){var t=parseInt(this.get("max")),e=this.$attachments().length;return t&&e>=t},getValue:function(){var t=[];return this.$attachments().each(function(){t.push($(this).data("id"))}),t},initialize:function(){this.$collection().sortable({items:".acf-gallery-attachment",forceHelperSize:!0,forcePlaceholderSize:!0,scroll:!0,start:function(t,e){e.placeholder.html(e.item.html()),e.placeholder.removeAttr("style")}}),this.$control().resizable({handles:"s",minHeight:200,stop:function(t,e){acf.update_user_setting("gallery_height",e.size.height)}}),this.on("resize",this.proxy(this.onResize),$(window)),this.on("change .acf-gallery-side",this.proxy(this.onUpdate)),this.render()},render:function(){var t=this.$(".acf-gallery-sort"),e=this.$(".acf-gallery-add"),a=this.$attachments().length;this.isFull()?e.addClass("disabled"):e.removeClass("disabled"),a?t.removeClass("disabled"):t.addClass("disabled"),this.resize()},resize:function(){var t=this.$control().width(),e=150,a=Math.round(t/150);a=Math.min(a,8),this.$control().attr("data-columns",a)},onResize:function(){this.resize()},openSidebar:function(){this.$control().addClass("-open");var t=this.$control().width()/3;t=parseInt(t),t=Math.max(t,350),this.$(".acf-gallery-side-inner").css({width:t-1}),this.$side().animate({width:t-1},250),this.$main().animate({right:t},250)},closeSidebar:function(){this.$control().removeClass("-open"),this.$active().removeClass("active"),acf.disable(this.$side());var t=this.$(".acf-gallery-side-data");this.$main().animate({right:0},250),this.$side().animate({width:0},250,function(){t.html("")})},onClickAdd:function(t,e){if(this.isFull())return void this.showNotice({text:acf._e("gallery","max"),type:"warning"});var a=acf.newMediaPopup({mode:"select",title:acf._e("gallery","select"),field:this.get("key"),multiple:"add",library:this.get("library"),allowedTypes:this.get("mime_types"),selected:this.val(),select:$.proxy(function(t,e){this.appendAttachment(t,e)},this)})},appendAttachment:function(t,e){if(t=this.validateAttachment(t),!this.isFull()&&!this.$attachment(t.id).length){var a=['<div class="acf-gallery-attachment" data-id="'+t.id+'">','<input type="hidden" value="'+t.id+'" name="'+this.getInputName()+'[]">','<div class="margin" title="">','<div class="thumbnail">','<img src="" alt="">',"</div>",'<div class="filename"></div>',"</div>",'<div class="actions">','<a href="#" class="acf-icon -cancel dark acf-gallery-remove" data-id="'+t.id+'"></a>',"</div>","</div>"].join(""),i=$(a);if(this.$collection().append(i),"prepend"===this.get("insert")){var n=this.$attachments().eq(e);n.length&&n.before(i)}this.renderAttachment(t),this.render(),this.getInput().trigger("change")}},validateAttachment:function(t){if(t=acf.parseArgs(t,{id:"",url:"",alt:"",title:"",filename:"",type:"image"}),t.attributes){t=t.attributes;var e=acf.isget(t,"sizes","medium","url");null!==e&&(t.url=e)}return t},renderAttachment:function(t){t=this.validateAttachment(t);var e=this.$attachment(t.id);"image"==t.type?e.find(".filename").remove():(t.url=acf.isget(t,"thumb","src"),e.find(".filename").text(t.filename)),t.url||(t.url=acf.get("mimeTypeIcon"),e.addClass("-icon")),e.find("img").attr({src:t.url,alt:t.alt,title:t.title}),acf.val(e.find("input"),t.id)},editAttachment:function(t){var e=acf.newMediaPopup({mode:"edit",title:acf._e("image","edit"),button:acf._e("image","update"),attachment:t,field:this.get("key"),select:$.proxy(function(t,e){this.renderAttachment(t)},this)})},onClickEdit:function(t,e){var a=e.data("id");a&&this.editAttachment(a)},removeAttachment:function(t){this.closeSidebar(),this.$attachment(t).remove(),this.render(),this.getInput().trigger("change")},onClickRemove:function(t,e){t.preventDefault(),t.stopPropagation();var a=e.data("id");a&&this.removeAttachment(a)},selectAttachment:function(t){var e=this.$attachment(t);if(!e.hasClass("active")){var a=this.proxy(function(){this.$side().find(":focus").trigger("blur"),this.$active().removeClass("active"),e.addClass("active"),this.openSidebar(),i()}),i=this.proxy(function(){var e={action:"acf/fields/gallery/get_attachment",field_key:this.get("key"),id:t};this.has("xhr")&&this.get("xhr").abort(),acf.showLoading(this.$sideData());var a=$.ajax({url:acf.get("ajaxurl"),data:acf.prepareForAjax(e),type:"post",dataType:"html",cache:!1,success:n});this.set("xhr",a)}),n=this.proxy(function(t){if(t){var e=this.$sideData();e.html(t),e.find(".compat-field-acf-form-data").remove(),e.find("> table.form-table > tbody").append(e.find("> .compat-attachment-fields > tbody > tr")),acf.do_action("append",e)}});a()}},onClickSelect:function(t,e){var a=e.data("id");a&&this.selectAttachment(a)},onClickClose:function(t,e){this.closeSidebar()},onChangeSort:function(t,e){var a=e.val();if(a){var i=[];this.$attachments().each(function(){i.push($(this).data("id"))});var n=this.proxy(function(){var t={action:"acf/fields/gallery/get_sort_order",field_key:this.get("key"),ids:i,sort:a},e=$.ajax({url:acf.get("ajaxurl"),dataType:"json",type:"post",cache:!1,data:acf.prepareForAjax(t),success:o})}),o=this.proxy(function(t){acf.isAjaxSuccess(t)&&(t.data.reverse(),t.data.map(function(t){this.$collection().prepend(this.$attachment(t))},this))});n()}},onUpdate:function(t,e){console.log("onUpdate");var a=this.$(".acf-gallery-update");if(!a.hasClass("disabled")){var i=acf.serialize(this.$sideData());a.addClass("disabled"),a.before('<i class="acf-loading"></i>'),i.action="acf/fields/gallery/update_attachment",$.ajax({url:acf.get("ajaxurl"),data:acf.prepareForAjax(i),type:"post",dataType:"json",complete:function(){a.removeClass("disabled"),a.prev(".acf-loading").remove()}})}}});acf.registerFieldType(t),acf.registerConditionForFieldType("hasValue","gallery"),acf.registerConditionForFieldType("hasNoValue","gallery"),acf.registerConditionForFieldType("lessThan","gallery"),acf.registerConditionForFieldType("greaterThan","gallery")}(jQuery);